\subsection{The File Database}
Easy access to large quantities of solar data frequently leads to datafiles accumulating
in local storage such as laptops and desktop computers. Keeping data organized and available
is typically a cumbersome task for the average user. The file database is a sub-package of 
Sunpy which is meant to solve this problem by providing a unified database to store and manage information about 
local data files. The database package was developed as part of the 2013 
Google Summer of Code. 

The database sub-package makes use of a database supported by
SQLAlchemy\footnote{\url{http://www.sqlalchemy.org}}. This library was chosen
since it supports many SQL dialects. If SQLite is choosen, the database is stored as a single file which is
created automatically. This solution makes it possible to easily backup, copy and distribute
a database file. A server-based database, on the other hand, could be used by a collaboration 
who work together from different machines on the
same data: a central database server stores all data and the clients connect to
it to read or write data.

The database can store and manage all data that is retrieved via sunpy from the net
package though currently only the \textsc{VSO} package is supported. 
It also possible to add entries manually by file or directory. The package also provides
a \texttt{fetch} method which provides a unified data search which includes both local files
and files on the \textsc{VSO} are searched. This reduces the likelihood of downloading the same file 
multiple times. When a file is added to the database the file is scanned and a file hash is produced. 
The current date is associated with the entry along with metadata summaries such 
as instrument, date of observation, field of view, etc. 
The database also provides the ability to associate custom meta-data to 
each database entry such as keywords, comments, and favoriting.

A very special feature of the database package is the support of \texttt{undo}
and \texttt{redo} operations. This is particularly convenient in
interactive sessions to easily revert accidental operations. 
This feature will also be desirable when creating a GUI frontend for this package.

Using the database package, one uses the \texttt{Database} class to connect
with a database and perform operations on it. Figure~\ref{code:database} shows how to connect
to an in-memory database and download data from the \textsc{VSO}. These entries are
automatically added to the database. The function \texttt{len} is used to get the number of
records. The function \texttt{display\_entries} displays an iterable of database entries
in a nicely-formatted \textsc{ASCII} table. The headlines correspond to the
attributes of the respective database entries.

\begin{listing}[H]
\begin{minted}{python}
>>> from sunpy.net import vso
>>> from sunpy.database import Database
>>> database = Database('sqlite:///')
>>> database.download(
...     vso.attrs.Time((2011, 9, 20, 1), (2011, 9, 20, 2)),
...     vso.attrs.Instrument('RHESSI'))
>>> len(database)
6
>>> from sunpy.database.tables import display_entries
>>> print display_entries(
...     database,
...     ['id', 'observation_time_start', 'wavemin', 'wavemax', 'download_time'])
id observation_time_start wavemin        wavemax           download_time      
-- ---------------------- -------        -------           -------------      
1  2011-09-20 01:09:20    0.413280643067 7.29318781883e-05 2014-01-18 19:21:35

\end{minted}
\caption{Example usage of the database sub-package.}
\label{code:database}
\end{listing}
